{% extends 'character/wizard/base_wizard.html' %}

{% block head %}
  {{ block.super }}
  <style>
    .review-section {
      background: rgba(0, 0, 0, 0.2);
      border: 1px solid #444;
      border-radius: 5px;
      padding: 15px;
      margin-bottom: 15px;
    }

    .review-section-title {
      color: var(--color-primary);
      font-size: 1rem;
      font-weight: bold;
      margin-bottom: 10px;
      border-bottom: 1px solid #444;
      padding-bottom: 5px;
    }

    .review-grid {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 10px;
    }

    .review-ability {
      text-align: center;
      padding: 10px;
      background: rgba(0, 0, 0, 0.3);
      border-radius: 5px;
    }

    .review-ability-name {
      font-size: 0.8rem;
      color: var(--color-text-muted);
    }

    .review-ability-score {
      font-size: 1.5rem;
      color: var(--color-primary);
      font-weight: bold;
    }

    .review-edit-link {
      float: right;
      font-size: 0.85rem;
      color: var(--color-mana);
      cursor: pointer;
    }

    .review-edit-link:hover {
      color: var(--color-primary);
    }

    @media (max-width: 600px) {
      .review-grid {
        grid-template-columns: repeat(2, 1fr);
      }
    }
  </style>
{% endblock %}

{% block wizard_form %}
  <p class="text-muted mb-2">Review your character and enter a name. Click "Create Character" when you're ready.</p>

  <div class="rpg-form-group">
    <label for="id_6-name">Character Name</label>
    {{ wizard.form.name }}
    {% if wizard.form.name.errors %}
      <div class="game-message error field-error">{{ wizard.form.name.errors }}</div>
    {% endif %}
  </div>

  {% if character_summary %}
    <!-- Species & Class -->
    <div class="review-section">
      <div class="review-section-title">
        Basic Info
        <button type="submit" name="wizard_goto_step" value="0" class="review-edit-link">Edit</button>
      </div>
      {% if character_summary.species %}
        <div class="preview-stat">
          <span class="preview-stat-label">Species</span>
          <span class="preview-stat-value">{{ character_summary.species.name }}</span>
        </div>
      {% endif %}
      {% if character_summary.klass %}
        <div class="preview-stat">
          <span class="preview-stat-label">Class</span>
          <span class="preview-stat-value">{{ character_summary.klass.name }}</span>
        </div>
      {% endif %}
      {% if character_summary.background %}
        <div class="preview-stat">
          <span class="preview-stat-label">Background</span>
          <span class="preview-stat-value">{{ character_summary.background }}</span>
        </div>
      {% endif %}
    </div>

    <!-- Abilities -->
    {% if character_summary.abilities %}
      <div class="review-section">
        <div class="review-section-title">
          Ability Scores
          <button type="submit" name="wizard_goto_step" value="2" class="review-edit-link">Edit</button>
        </div>
        <div class="review-grid">
          <div class="review-ability">
            <div class="review-ability-name">STR</div>
            <div class="review-ability-score">{{ character_summary.abilities.strength }}</div>
          </div>
          <div class="review-ability">
            <div class="review-ability-name">DEX</div>
            <div class="review-ability-score">{{ character_summary.abilities.dexterity }}</div>
          </div>
          <div class="review-ability">
            <div class="review-ability-name">CON</div>
            <div class="review-ability-score">{{ character_summary.abilities.constitution }}</div>
          </div>
          <div class="review-ability">
            <div class="review-ability-name">INT</div>
            <div class="review-ability-score">{{ character_summary.abilities.intelligence }}</div>
          </div>
          <div class="review-ability">
            <div class="review-ability-name">WIS</div>
            <div class="review-ability-score">{{ character_summary.abilities.wisdom }}</div>
          </div>
          <div class="review-ability">
            <div class="review-ability-name">CHA</div>
            <div class="review-ability-score">{{ character_summary.abilities.charisma }}</div>
          </div>
        </div>
      </div>
    {% endif %}

    <!-- Skills -->
    {% if character_summary.skills %}
      <div class="review-section">
        <div class="review-section-title">
          Skills
          <button type="submit" name="wizard_goto_step" value="4" class="review-edit-link">Edit</button>
        </div>
        <ul class="preview-list">
          {% for skill in character_summary.skills %}
            <li>{{ skill }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}

    <!-- Equipment -->
    {% if character_summary.equipment %}
      <div class="review-section">
        <div class="review-section-title">
          Equipment
          <button type="submit" name="wizard_goto_step" value="5" class="review-edit-link">Edit</button>
        </div>
        <ul class="preview-list">
          {% for item in character_summary.equipment %}
            <li>{{ item }}</li>
          {% endfor %}
        </ul>
      </div>
    {% endif %}
  {% endif %}
{% endblock %}

{% block wizard_preview %}
  <div class="preview-title">Character Ready</div>
  <div class="text-center" style="padding: 20px;">
    <div style="font-size: 4rem; margin-bottom: 15px;">&#9876;</div>
    <p class="text-muted">
      Your character is ready to begin their adventure!
    </p>
    <p class="text-muted" style="font-size: 0.9rem;">
      Review the details on the left, enter a name, and click "Create Character" to finish.
    </p>
  </div>
{% endblock %}
